<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>如何使用 C# 實現 Proxy Pattern ? | 點燈坊</title>
  <meta name="author" content="真 OO無双">
  
  <meta name="description" content="使用 FP 將有不同的實現方式">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
 <meta name="description" content="使用 FP 將有不同的實現方式">
<meta property="og:type" content="article">
<meta property="og:title" content="如何使用 C# 實現 Proxy Pattern ?">
<meta property="og:url" content="https://oomusou.io/design-pattern/proxy/index.html">
<meta property="og:site_name" content="點燈坊">
<meta property="og:description" content="使用 FP 將有不同的實現方式">
<meta property="og:image" content="https://oomusou.io/images/feature/logo.png">
<meta property="og:updated_time" content="2018-04-22T02:16:05.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="如何使用 C# 實現 Proxy Pattern ?">
<meta name="twitter:description" content="使用 FP 將有不同的實現方式">
 

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
     <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		<li><a  href="/">點燈坊</a></li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class="fa fa-rss"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 
	
		<div class="page-header">		
			<h1> 如何使用 C# 實現 Proxy Pattern ?</h1>
		</div>		
	



<div class="row post">
	<!-- cols -->
	
	<div class="col-md-9">
	

	
		 <div class="alert alert-success description">
			<i class="fa fa-info-circle"></i> 使用 FP 將有不同的實現方式			
		</div> <!-- alert -->
		

	<!-- toc -->
	<div id="postTOC">
		<span class="tocHeading">Contents</span>
		<ol class="toc-article"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Version"><span class="toc-article-text">Version</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#User_Story_1"><span class="toc-article-text">User Story 1</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#User_Story_2"><span class="toc-article-text">User Story 2</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Inheritance"><span class="toc-article-text">Inheritance</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Proxy_Pattern"><span class="toc-article-text">Proxy Pattern</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Func"><span class="toc-article-text">Func</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Refactoring"><span class="toc-article-text">Refactoring</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Summary"><span class="toc-article-text">Summary</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Conclusion"><span class="toc-article-text">Conclusion</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Sample_Code"><span class="toc-article-text">Sample Code</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Reference"><span class="toc-article-text">Reference</span></a></li></ol>
    </div>

	<!-- content -->
	<div class="mypage">		
	    <p>Proxy Pattern 是 OOP 中著名的 Design Pattern，尤其可在不改變 interface 的前提下，就能控制該物件的使用，隨著 FP 逐漸受到重視， Proxy Pattern 在實作上也有了新的面貌。</p>
<a id="more"></a>
<h2 id="Version">Version</h2><hr>
<p>macOS High Sierra 10.13.3<br>.NET Core SDK 2.1.101<br>Rider 2017.3.1<br>C# 7.2</p>
<h2 id="User_Story_1">User Story 1</h2><hr>
<p>假設你在處理訂單，為了慶祝週年慶，<code>全館八折</code>。</p>
<p><strong>Task</strong><br>將 <code>OrderService</code> 包在 <code>OrderLibrary</code> assembly 內。</p>
<p><strong>Architecture</strong><br><img src="/images/design-pattern/proxy/proxy004.svg" alt="proxy004"></p>
<p><strong>Implementation</strong><br><strong>Client</strong></p>
<p><img src="/images/design-pattern/proxy/proxy005.svg" alt="proxy004"></p>
<p><strong>Program.cs</strong><br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> OrderLibrary;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            PriceInterface orderService = <span class="keyword">new</span> OrderService();</span><br><span class="line">            <span class="keyword">var</span> realPrice = orderService.GetPrice(<span class="number">0.8</span>, <span class="number">800</span>);</span><br><span class="line">            </span><br><span class="line">            Console.WriteLine(<span class="string">"Real price : &#123;0&#125;"</span>, realPrice);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>與一般使用 service 寫法相同，建立 <code>OrderService</code> 物件，並執行 <code>getPrice()</code> 計算 <code>全館八折</code>。</p>
<p><strong>PriceInterface</strong></p>
<p><img src="/images/design-pattern/proxy/proxy006.svg" alt="proxy004"></p>
<p><strong>PriceInterface.cs</strong><br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">OrderLibrary</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">PriceInterface</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">double</span> <span class="title">GetPrice</span>(<span class="params"><span class="keyword">double</span> discount, <span class="keyword">double</span> price</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>PriceInterface</code> 定義 <code>OrderService</code> 的 interface，只有 <code>GetPrice()</code> 一個 method。</p>
<p><strong>OrderService</strong><br><img src="/images/design-pattern/proxy/proxy007.svg" alt="proxy007"></p>
<p><strong>OrderService.cs</strong><br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">OrderLibrary</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderService</span> : <span class="title">PriceInterface</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">GetPrice</span>(<span class="params"><span class="keyword">double</span> discount, <span class="keyword">double</span> price</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> discount * price;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>OrderService</code> 實踐 <code>PriceInterface</code> 的 <code>GetPrice()</code>，計算 <code>全館八折</code>。</p>
<blockquote>
<p>目前 <code>PriceInterface</code> 與 <code>OrderService</code> 都包在 <code>OrderLibrary</code> assembly 內，與 <code>Client</code> 的 <code>ConsoleApp</code> 是不同 assembly。</p>
</blockquote>
<h2 id="User_Story_2">User Story 2</h2><hr>
<p>週年慶過後，只有 <code>會員</code> 才享有 <code>全館八折</code>，一般消費者維持原價。</p>
<p><strong>Task</strong></p>
<ul>
<li>由於 <code>開放封閉原則</code>， <code>OrderLibrary</code> 不再修改與編譯</li>
<li>在相同的 <code>PriceInterface</code> 下，要使 <code>Client</code> 的修改程式碼降到最低</li>
</ul>
<h2 id="Inheritance">Inheritance</h2><p><strong>Architecture</strong></p>
<p><img src="/images/design-pattern/proxy/proxy002.svg" alt="proxy002"></p>
<ul>
<li><strong>Client</strong>：<code>OrderService</code> 的 user，實務上可能是 component 或 controller</li>
<li><strong>PriceInterface</strong>：定義 <code>OrderService</code> 的 interface</li>
<li><strong>OrderService</strong>：實現 <code>全館八折</code></li>
<li><strong>MemberOrderService</strong>：根據 <code>MemberService</code> 判斷 <code>是否為會員</code>，並且因為 code reuse 繼承 <code>OrderService</code></li>
<li><strong>MemberService</strong>：判斷 <code>是否為會員</code></li>
</ul>
<p><strong>Implementation</strong></p>
<p><strong>MemberService</strong></p>
<p><img src="/images/design-pattern/proxy/proxy012.svg" alt="proxy012"></p>
<p><strong>MemberService.cs</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MemberLibrary</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MemberService</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">IsMember</span>(<span class="params"><span class="keyword">string</span> account</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> account == <span class="string">"Sam"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因為要判斷是否為 <code>會員</code>，新增 <code>MemberService</code>。</p>
<blockquote>
<p>實務上判斷 <code>是否為會員</code> 與資料庫有關，本文主要是談 Proxy Pattern，就只簡單的判斷會員是否為 <code>Sam</code> 即可。</p>
</blockquote>
<p><strong>MemberOrderService</strong></p>
<p><img src="/images/design-pattern/proxy/proxy013.svg" alt="proxy013"></p>
<p><strong>MemberOrderService.cs</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> MemberLibrary;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">OrderLibrary</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MemberOrderService</span> : <span class="title">OrderService</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> MemberService _memberService = <span class="keyword">new</span> MemberService();</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">double</span> <span class="title">GetPrice</span>(<span class="params"><span class="keyword">double</span> discount, <span class="keyword">double</span> price</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _memberService.IsMember(<span class="string">"Sam"</span>) ? </span><br><span class="line">                   <span class="keyword">base</span>.GetPrice(price, discount) : </span><br><span class="line">                   price;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第 5 行<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MemberOrderService</span> : <span class="title">OrderService</span></span><br></pre></td></tr></table></figure></p>
<p>由於只是多了 <code>是否為會員</code> 判斷，<code>全館八折</code> 的邏輯還是一樣，因此最直覺的寫法就是直接繼承 <code>OrderService</code> 在加以 <code>override</code>。</p>
<p>第 7 行</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> MemberService _memberService = <span class="keyword">new</span> MemberService();</span><br></pre></td></tr></table></figure>
<p>由於需使用 <code>MemberService</code> 判斷 <code>是否為會員</code>，因此宣告 <code>MemberService</code> 為 private field。</p>
<blockquote>
<p>實務上不應該直接 <code>new</code> service，而應該使用 DI 注入解耦合，因為本文主是談 Proxy Pattern，因此就偷懶直接 <code>new</code> 了。</p>
</blockquote>
<p>11 行</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> _memberService.IsMember(<span class="string">"Sam"</span>) ? </span><br><span class="line">       <span class="keyword">base</span>.GetPrice(price, discount) : </span><br><span class="line">       price;</span><br></pre></td></tr></table></figure>
<p>由於 <code>MemberOrderService</code> 繼承 <code>OrderService</code>，因此使用 <code>base.GetPrice()</code> 呼叫父類別 <code>OrderService</code> 的 <code>GetPrice()</code>。</p>
<p><strong>OrderService</strong></p>
<p><img src="/images/design-pattern/proxy/proxy014.svg" alt="proxy014"></p>
<p><strong>OrderService.cs</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">OrderLibrary</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderService</span> : <span class="title">PriceInterface</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">GetPrice</span>(<span class="params"><span class="keyword">double</span> discount, <span class="keyword">double</span> price</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> discount * price;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 因為 <code>MemberOrderService</code> 要 override <code>GetPrice()</code>，所以在 <code>OrderService</code> 必須宣告成 <code>virtual</code>。</p>
<blockquote>
<p>Q：使用 <code>繼承</code> 有什麼問題？</p>
</blockquote>
<ol>
<li><code>OrderService.GetPrice()</code> 必須改成 <code>virtual</code>，<code>OrderLibrary</code> 必須修改與重新編譯，違反 <code>OrderLibrary 不再修改與編譯</code> 的需求，也違反 <code>開放封閉原則</code></li>
<li><code>MemberOrderService</code> 必須加在 <code>OrderLibrary</code> assembly，違反 <code>OrderLibrary 不再修改與編譯</code> 的需求，也違反 <code>開放封閉原則</code></li>
<li><code>繼承</code> 就該符合 <code>里氏替換原則</code>，也就是無論怎麼繼承， <code>GetPrice()</code> 都該只是計算 price，但 <code>MemberOrderService.GetPrice()</code> 卻還去判斷 <code>IsMember()</code>，這已經超出 <code>GetPrice()</code> 的職責，也就是違反 <code>單一職責原則</code></li>
<li><code>MemberOrderService</code> 完全以 code reuse 的角度去繼承 <code>OrderService</code>，而不是以 <code>多型</code> 的角度去繼承 <code>OrderService</code>，這也違反 <code>里氏替換原則</code></li>
<li><code>MemberOrderService</code> 與 <code>OrderService</code> 強耦合，將來在  <code>OrderService</code> 新增任何 field 與 method，都會污染到 <code>MemberOrderService</code>，違反 <code>介面隔離原則</code></li>
</ol>
<blockquote>
<p><code>繼承</code> 不是不能用，若真的沒有駕馭 <code>繼承</code> 的功力，建議就遵循 <code>里氏替換原則</code></p>
</blockquote>
<h2 id="Proxy_Pattern">Proxy Pattern</h2><hr>
<p><strong>Definition</strong></p>
<blockquote>
<p>Proxy Pattern</p>
<p>在不改變原有 interface 的前提下，控制 service 的使用</p>
</blockquote>
<p><img src="/images/design-pattern/proxy/proxy015.svg" alt="proxy015"></p>
<ul>
<li><strong>Client</strong>：<code>Proxy</code> 的 user，實務上可能是 component 或 controller</li>
<li><strong>Subject</strong>：定義 <code>Proxy</code> 與 <code>RealSubject</code> 的共用 interface</li>
<li><strong>Proxy</strong> : <code>RealSubject</code> 的替身，<code>Client</code> 實際只接觸 <code>Proxy</code>， 再由 <code>Proxy</code> 呼叫 <code>RealSubject</code></li>
<li><strong>RealSubject</strong>：實際功能的物件</li>
</ul>
<p><strong>適用時機</strong></p>
<ul>
<li>原有 interface 不能變動而想控制 service 使用</li>
<li>原來的 class 在不同 assembly，無法修改 code 卻想控制 service 使用</li>
<li>原本使用繼承而造成強耦合</li>
</ul>
<p><strong>優點</strong></p>
<ul>
<li>Interface 沒有變動，因此 client 程式不用修改 (如 .NET Core 的 Type Forwarding 設計)</li>
</ul>
<blockquote>
<p>在 GoF 的 Proxy Pattern，有提到四種 proxy，分別為 Remote Proxy、Virtual Proxy、Protection Proxy、Smart Reference，本文只針對最常用的 Protection Proxy 討論</p>
</blockquote>
<p><strong>Architecture</strong><br><img src="/images/design-pattern/proxy/proxy000.svg" alt="proxy000"></p>
<ul>
<li><strong>Client</strong>：<code>OrderProxy</code> 的 user，實務上可能是 component 或 controller</li>
<li><strong>PriceInterface</strong>：定義 <code>OrderProxy</code> 與 <code>OrderService</code> 的共用 interface，相當於 <code>Subject</code></li>
<li><strong>OrderProxy</strong>：控制 <code>OrderService</code> 的使用，相當於 <code>Proxy</code></li>
<li><strong>OrderService</strong>：實際計算 <code>全館八折</code>，相當於 <code>RealSubject</code></li>
<li><strong>MemberService</strong>：判斷是否為會員，為 <code>OrderService</code> 所依賴的物件</li>
</ul>
<p><strong>Implementation</strong></p>
<p><strong>OrderProxy</strong></p>
<p><img src="/images/design-pattern/proxy/proxy003.svg" alt="proxy003"></p>
<p><strong>OrderProxy.cs</strong><br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> MemberLibrary;</span><br><span class="line"><span class="keyword">using</span> OrderLibrary;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderProxy</span> : <span class="title">PriceInterface</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> PriceInterface _orderService = <span class="keyword">new</span> OrderService();</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> MemberService _memberService = <span class="keyword">new</span> MemberService();</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">GetPrice</span>(<span class="params"><span class="keyword">double</span> discount, <span class="keyword">double</span> price</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _memberService.IsMember(<span class="string">"Sam"</span>) ? </span><br><span class="line">                   _orderService.GetPrice(discount, price) : </span><br><span class="line">                   price;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>第 6 行<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderProxy</span> : <span class="title">PriceInterface</span></span><br></pre></td></tr></table></figure></p>
<p>為了要達成 <code>使 Client 的修改程式碼降到最低</code> 的要求，<code>OrderProxy</code> 也繼續使用 <code>PriceInterface</code>。</p>
<p>第 8 行<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> PriceInterface _orderService = <span class="keyword">new</span> OrderService();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> MemberService _memberService = <span class="keyword">new</span> MemberService();</span><br></pre></td></tr></table></figure></p>
<p>由於 <code>OrderProxy</code> 有兩個相依的 service：<code>OrderService</code> 與  <code>MemberService</code>，因此宣告為 private field 儲存。</p>
<blockquote>
<p>實務上不應該直接 <code>new</code> service，而應該使用 DI 注入解耦合，因為本文主是談 Proxy Pattern，因此就偷懶直接 <code>new</code> 了。</p>
</blockquote>
<p>11 行</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">GetPrice</span>(<span class="params"><span class="keyword">double</span> price, <span class="keyword">double</span> discount</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _memberService.IsMember(<span class="string">"Sam"</span>) ? </span><br><span class="line">           _orderService.GetPrice(price, discount) : </span><br><span class="line">           price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>先判斷是否為會員，在執行 <code>OrderService.GetPrice()</code>。</p>
<p>重點在於在呼叫 service 的之前與之後，我們都可以加上自己的邏輯，而不是直接呼叫 service，這就是 proxy 本質。</p>
<p><strong>Client</strong><br><img src="/images/design-pattern/proxy/proxy001.svg" alt="proxy001"></p>
<p><strong>Program.cs</strong><br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> OrderLibrary;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            PriceInterface orderProxy = <span class="keyword">new</span> OrderProxy();</span><br><span class="line">            <span class="keyword">var</span> realPrice = orderProxy.GetPrice(<span class="number">0.8</span>, <span class="number">800</span>);</span><br><span class="line">            </span><br><span class="line">            Console.WriteLine(<span class="string">"Real price : &#123;0&#125;"</span>, realPrice);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>10 行</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PriceInterface orderProxy = <span class="keyword">new</span> OrderProxy();</span><br></pre></td></tr></table></figure>
<p>由 <code>OrderService</code> 改成 <code>OrderProxy</code>，再透過 Refactoring 的 <code>Rename</code> 將 <code>orderService</code> 重構成 <code>orderProxy</code>。</p>
<p>其他都不用改，達成 <code>使 Client 的修改程式碼降到最低</code> 的要求。</p>
<blockquote>
<p>Q：<code>OrderProxy.GetPrice()</code> 與 <code>MemberOrderService.GetPrice()</code> 的程式碼差異不大，為什麼寫在 proxy 就可以，寫在 <code>繼承</code> 就不行？</p>
</blockquote>
<p>就功能而言，Proxy 與 <code>繼承</code> 都能達到需求，但語意不一樣：</p>
<ul>
<li>Proxy 目的就是 <code>控制 service 的使用</code>，所以加上 <code>IsMember()</code> 判斷就天經地義，這就是它的職責</li>
<li><code>OrderProxy</code> 並沒有使用 <code>繼承</code>，因此不受 <code>里式替換原則</code> 約束，interface 只要遵循 <code>介面隔離原則</code> 即可</li>
</ul>
<h2 id="Func">Func<t></t></h2><hr>
<p>雖然先定義好 <code>PriceInterface</code>，讓 <code>OrderService</code> 與 <code>OrderProxy</code> 共用 interface 的理念很好，但 …</p>
<ul>
<li>只有 <code>GetPrice()</code> 一個 method，真的需要開 interface 嗎？</li>
<li>真的有必要特別實作 <code>OrderProxy</code> 嗎？</li>
</ul>
<p><strong>Architecture</strong></p>
<p><img src="/images/design-pattern/proxy/proxy008.svg" alt="proxy008"></p>
<p><strong>Implementation</strong></p>
<p><strong>OrderService</strong></p>
<p><img src="/images/design-pattern/proxy/proxy009.svg" alt="proxy009"></p>
<p><strong>OrderService.cs</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">OrderLibrary</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">OrderService</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">GetPrice</span>(<span class="params"><span class="keyword">double</span> discount, <span class="keyword">double</span> price</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> discount * price;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由於 <code>OrderService</code> 都沒用到 field (state)， 是 pure function，因此可以將 <code>GetPrice()</code> 與 <code>OrderService</code> 全部改成 static。</p>
<p><strong>MemberService</strong><br><img src="/images/design-pattern/proxy/proxy010.svg" alt="proxy010"></p>
<p><strong>MemberService.cs</strong><br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MemberLibrary</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MemberService</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">IsMember</span>(<span class="params"><span class="keyword">string</span> account</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> account == <span class="string">"Sam"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>由於 <code>MemberService</code>  也沒用到 field (state)，也是 pure function，因此將 <code>IsMember()</code> 與 <code>MemberService</code> 全部改成 static。</p>
<p><strong>Client</strong></p>
<p><img src="/images/design-pattern/proxy/proxy011.svg" alt="proxy011"></p>
<p><strong>Program.cs</strong><br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> MemberLibrary;</span><br><span class="line"><span class="keyword">using</span> OrderLibrary;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            Func&lt;<span class="keyword">double</span>, <span class="keyword">double</span>, <span class="keyword">double</span>&gt; OrderProxy(Predicate&lt;<span class="keyword">string</span>&gt; isMember) =&gt;</span><br><span class="line">                isMember(<span class="string">"Sam"</span>) ? </span><br><span class="line">                (Func&lt;<span class="keyword">double</span>, <span class="keyword">double</span>, <span class="keyword">double</span>&gt;) OrderService.GetPrice : </span><br><span class="line">                (discount, price) =&gt; price;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">var</span> realPrice = OrderProxy(MemberService.IsMember)(<span class="number">0.8</span>, <span class="number">800</span>);</span><br><span class="line">            </span><br><span class="line">            Console.WriteLine(<span class="string">"Real price : &#123;0&#125;"</span>, realPrice);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>11 行</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;<span class="keyword">double</span>, <span class="keyword">double</span>, <span class="keyword">double</span>&gt; OrderProxy(Predicate&lt;<span class="keyword">string</span>&gt; isMember) =&gt;</span><br><span class="line">    isMember(<span class="string">"Sam"</span>) ? </span><br><span class="line">    (Func&lt;<span class="keyword">double</span>, <span class="keyword">double</span>, <span class="keyword">double</span>&gt;) OrderService.GetPrice : </span><br><span class="line">    (discount, price) =&gt; price;</span><br></pre></td></tr></table></figure>
<p>將 <code>OrderProxy</code> 由 class 退化成 function，但 signature 仍然是 <code>Func&lt;double, double, double&gt;</code>，與原本的 <code>PriceInterface</code> 的 signature 一樣。</p>
<p>在 <code>OrderProxy</code> class 的 dependency，我們使用 DI 解決 <code>依賴反轉原則</code> 要求，但 FP 該如何做呢 ?</p>
<p>其實很簡單，function 就是 dependency，將 function 當參數傳入就好，也就是把 <code>orderProxy()</code> 當成 Higher Order Function，再將 <code>MemberService.IsMember()</code> 當成 predicate function 傳入 <code>orderProxy()</code> 即可。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(Func&lt;<span class="keyword">double</span>, <span class="keyword">double</span>, <span class="keyword">double</span>&gt;) OrderService.GetPrice :</span><br></pre></td></tr></table></figure>
<p>需要 <code>Func&lt;double, double, double&gt;</code> 轉型是因為 C# Type Inference 需求，所以一定得加。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(discount, price) =&gt; price;</span><br></pre></td></tr></table></figure>
<p>由於 signature 要求為 <code>Func&lt;double, double, double&gt;</code>，所以 Lambda 的 input 一定要兩個參數，儘管只使用到 <code>price</code>。</p>
<blockquote>
<p>由此可發現所以 return function 都必須符合 <code>Func&lt;double, double, double&gt;</code>，這與 class interface 的本質是一樣的</p>
</blockquote>
<p>16 行</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> realPrice = OrderProxy(MemberService.IsMember)(<span class="number">0.8</span>, <span class="number">800</span>);</span><br></pre></td></tr></table></figure>
<p><code>orderProxy(MemberService.IsMember)</code> 回傳為一 anonymous function，其中 <code>MemberService.IsMember</code> 為 function dependency，而  <code>(discount, originalPrice)</code> 為 anonymous function 的參數。</p>
<p>也就是原本是</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> realPrice = orderService(discount, originalPrice);</span><br></pre></td></tr></table></figure>
<p>因為 <code>orderProxy()</code> 回傳的 anonymous function 與 <code>orderService()</code> 的 signature 都是 <code>Func&lt;double, double, double&gt;</code>，所以其本質與 Proxy Pattern 都遵守 <code>PriceInterface</code> 意義是一樣的，只是 FP 使用 proxy function，而 OOP 使用 proxy class。</p>
<h2 id="Refactoring">Refactoring</h2><hr>
<p>或許你會覺得 <code>OrderProxy()</code> 這個 local function 放在 <code>Client</code> 太過沈重，想另外 <code>Move Method</code> 到 <code>OrderProxy</code> class，那也非常簡單。</p>
<p><img src="/images/design-pattern/proxy/proxy016.svg" alt="proxy016"></p>
<p><strong>OrderProxy</strong><br><img src="/images/design-pattern/proxy/proxy017.svg" alt="proxy017"></p>
<p><strong>OrderProxy.cs</strong><br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> OrderLibrary;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">OrderProxy</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Func&lt;<span class="keyword">double</span>, <span class="keyword">double</span>, <span class="keyword">double</span>&gt; GetPrice(Predicate&lt;<span class="keyword">string</span>&gt; isMember)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> isMember(<span class="string">"Sam"</span>) ? </span><br><span class="line">                   (Func&lt;<span class="keyword">double</span>, <span class="keyword">double</span>, <span class="keyword">double</span>&gt;) OrderService.GetPrice : </span><br><span class="line">                   (discount, price) =&gt; price;</span><br><span class="line">        &#125;</span><br><span class="line">            </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>將 <code>OrderProxy()</code> local function 透過 Refactoring 的 <code>Move Method</code> 到 <code>OrderProxy</code> class，直接將 local function <code>剪下貼上</code> 即可。</p>
<blockquote>
<p><code>Move Method</code> 在 OOP Refactoring 雖然很基本，但實務上卻不容易達到，主要是因為 OOP 的 method 會與 field 有關，要 <code>Move Method</code> 可能得先 <code>Move Field</code>，要 <code>Move Field</code> 又可能得先 <code>Self Encapsulate Field</code>，然後又會發現更多 method 也必須跟著 <code>Move Method</code>，總之會是一連串的 combo 動作。</p>
<p>但若是 Pure Function，則 <code>Move Method</code> 非常容易，只是 <code>剪下貼上</code> 即可，因為完全不涉及 field，也不會與其他 method 有關，所以 FP 非常適合重構 <code>Move Method</code>。</p>
</blockquote>
<p><strong>Client</strong><br><img src="/images/design-pattern/proxy/proxy018.svg" alt="proxy018"></p>
<p><strong>Program.cs</strong><br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> MemberLibrary;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> realPrice = OrderProxy.GetPrice(MemberService.IsMember)(<span class="number">0.8</span>, <span class="number">800</span>);</span><br><span class="line">            </span><br><span class="line">            Console.WriteLine(<span class="string">"Real price : &#123;0&#125;"</span>, realPrice);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>Client</code> 提供 <code>OrderProxy.GetPrice()</code> 的 dependency function 後，就可處理訂單了。</p>
<blockquote>
<p> 從 OOP 原本具有 <code>垂直</code> 特性的架構，經過 FP 重構後，出現 <code>水平</code> 近似 <code>鐵道</code> 的架構，也就是所謂的 <code>Railway Oriented Programming</code>，因為重構到最後的架構都是 <code>水平</code> 的，剛好就是 FP 所強調的 Pipeline 與 Function Composition。</p>
</blockquote>
<h2 id="Summary">Summary</h2><hr>
<blockquote>
<p>Q：Proxy Pattern 與 Decorator Pattern 有什麼差異？</p>
</blockquote>
<p><strong>Proxy Pattern</strong><br><img src="/images/design-pattern/proxy/proxy020.svg" alt="proxy018"></p>
<p><strong>Decorator Pattern</strong><br><img src="/images/design-pattern/proxy/proxy019.svg" alt="proxy019"></p>
<p>以 class diagram 角度，Proxy Pattern 與 Decorator Pattern 的確非常類似。</p>
<blockquote>
<p>學 Design Pattern 不能以 class diagram 的角度去思考，而要以他要解決什麼問題來思考</p>
</blockquote>
<p><strong>Similarity</strong></p>
<ul>
<li>都在解決 <code>繼承濫用</code> </li>
<li>Interface 都不會改變</li>
</ul>
<p><strong>Difference</strong></p>
<ul>
<li>Proxy 目的在對 service 做 <code>控制存取</code>；Decorator 目的在對 service <code>增加功能</code></li>
<li>Proxy 與 Subject 只能在 compile-time <code>靜態對應</code>；Decorator 能在 run-time <code>動態新增</code></li>
</ul>
<h2 id="Conclusion">Conclusion</h2><hr>
<ul>
<li><code>繼承</code> 通常是 OOP 最直覺的作法，但也是維護上最容易出問題的地方，Proxy Pattern 與 Decorator Pattern 提供了 <code>繼承</code> 的取代方案，讓 client 與 service 之間的依賴僅限於 interface，而不是 concrete service</li>
<li>Proxy Pattern 與 Decorator Pattern 非常類似，也都在解決 <code>繼承</code> 的老問題，但 Proxy Pattern 重點在於 <code>控制存取</code>，而 Decorator Pattern 重點在於 <code>增加功能</code></li>
<li>Proxy class 亦可使用 Proxy function 取代，如此 interface 與 proxy class 都可省略，依賴注入可改用 Higher Order Function 解決。</li>
</ul>
<h2 id="Sample_Code">Sample Code</h2><hr>
<p>完整的範例可以在我的 <a href="https://github.com/oomusou/Core2OrderProxy" target="_blank" rel="external">GitHub</a> 上找到</p>
<h2 id="Reference">Reference</h2><hr>
<p><a href="https://sourcemaking.com/" target="_blank" rel="external">Source Making</a>, <a href="https://sourcemaking.com/design_patterns/proxy" target="_blank" rel="external">Proxy Design Pattern</a></p>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/fsharp/proxy/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
  		

        <li><a href="/tags"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/fsharp/list-module-function-part3/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>
	
	<!-- comment -->
	
	
	</div> <!-- col-md-9/col-md-12 -->
	
	
		<div class="col-md-3"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2018-04-12 
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/C/">C#<span>16</span></a></li> <li><a href="/tags/Design-Pattern/">Design Pattern<span>17</span></a></li>
    </ul>
	</div>
		

    <hr>
	
</div><!-- col-md-3 -->

	

</div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
  <footer>  </footer>
</div> <!-- container-narrow -->
  
  <script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'hAXbiVYFC92XF16_EhCh','2.0.0');
  </script>



  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
   </html>
